# Unused Metic Processor

<!-- status autogenerated section -->
| Status        |           |
| ------------- |-----------|
| Stability     | [alpha]: metrics   |
| Distributions | [ntakashi-otel-collector] |
| Issues        | [![Open issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aopen%20label%3Aprocessor%2Funusedmetric%20&label=open&color=orange&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aopen+is%3Aissue+label%3Aprocessor%2Funusedmetric) [![Closed issues](https://img.shields.io/github/issues-search/open-telemetry/opentelemetry-collector-contrib?query=is%3Aissue%20is%3Aclosed%20label%3Aprocessor%2Funusedmetric%20&label=closed&color=blue&logo=opentelemetry)](https://github.com/open-telemetry/opentelemetry-collector-contrib/issues?q=is%3Aclosed+is%3Aissue+label%3Aprocessor%2Funusedmetric) |
| Code coverage | [![codecov](https://codecov.io/github/open-telemetry/opentelemetry-collector-contrib/graph/main/badge.svg?component=processor_unusedmetric)](https://app.codecov.io/gh/open-telemetry/opentelemetry-collector-contrib/tree/main/?components%5B0%5D=processor_unusedmetric&displayType=list) |
| [Code Owners](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/CONTRIBUTING.md#becoming-a-code-owner)    | [@nicolastakashi](https://www.github.com/nicolastakashi) |

[alpha]: https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/component-stability.md#alpha
[ntakashi-otel-collector]: TBD
<!-- end autogenerated section -->

## Overview

The Unused Metric Processor is an experimental OpenTelemetry Collector component that filters out unused metrics from telemetry pipelines. The processor queries a Prometheus analytics server to determine which metrics are actively being used, and automatically drops any metrics that are not being consumed or queried.

This helps reduce storage costs and improve pipeline performance by eliminating metrics that provide no value to your monitoring and alerting systems.

The processor integrates with the [prom-analytics-proxy](https://github.com/nicolastakashi/prom-analytics-proxy) project, which tracks actual metric usage patterns in production environments.

## Features

- **Real-time Usage Checking**: Queries Prometheus analytics server to determine if metrics are actively being used
- **Automatic Metric Dropping**: Drops unused metrics from the pipeline to reduce storage and processing overhead
- **Prometheus Integration**: Works with prom-analytics-proxy to access real usage data from your Prometheus instance
- **Performance Optimization**: Reduces storage costs and improves pipeline efficiency by eliminating unused metrics

## Configuration

The `unusedmetric` processor can be configured with the following options:

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| `server.address` | string | - | **Required.** The address of the Prometheus analytics server (prom-analytics-proxy) |
| `server.timeout` | duration | `10s` | Timeout for analytics server requests |
| `server.tls_config.insecure_skip_verify` | bool | `false` | Skip TLS certificate verification for the analytics server |

## Example Configuration

Here's an example of how to configure the Unused Metric Processor:

```yaml
processors:
  unusedmetric:
    server:
      address: http://localhost:9092
      timeout: 10s
      tls_config:
        insecure_skip_verify: true
```

In this example:

- The processor connects to a prom-analytics-proxy server at `http://localhost:9092`
- It queries this server to check if each metric is being used
- Metrics that are not being used are automatically dropped from the pipeline
- It has a 10-second timeout for analytics server requests
- TLS verification is disabled for development purposes
